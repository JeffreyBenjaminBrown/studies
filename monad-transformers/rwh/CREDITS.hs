Based on the code from Real World Haskell, Chapter 18: Monad transformers
  http://book.realworldhaskell.org/read/monad-transformers.html
